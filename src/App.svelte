<script lang="ts">
  // Imports
  import { randomRange } from "./lib/math.js";
  import type { ScoreCardType } from "./app.type";

  // Components
  import Question from "./Quiz/Question.svelte";
  import QuizResults from "./ScoreCard/Layout.svelte";
  import Landing from "./Landing.svelte";
  import Tailwindcss from "./Tailwindcss.svelte";

  // Counters
  let qPage = 0;
  let q = 8;
  let answers: ScoreCardType[] = Array(q).fill({});

  // Store
  let questions = Array(q).fill(0).map(randomRange);

  // Toggles
  let setup = false;

  // Receive Component Event
  const updateAnswers = (event) => {
    answers[qPage] = { Hz: questions[qPage], ...event.detail };
    qPage++;
  };

  // Local Lambdas
  const resetQuiz = () => {
    questions = Array(q).fill(0).map(randomRange);
    answers = Array(q).fill({});
    qPage = 0;
  };
</script>

<style lang="postcss">
  main {
    @apply mx-auto px-10 py-4;
  }
  main header img {
    @apply object-contain h-32 w-full;
  }
  footer.socials {
    @apply mt-5 pt-5 border-t-4 border-gray-200;
  }
  footer.socials svg {
    @apply object-contain h-16 w-full opacity-50;
    filter: grayscale(80%);
    @apply;
  }
  footer.socials svg:hover {
    @apply opacity-100 cursor-pointer;
    filter: grayscale(0%);
  }
  footer.socials a {
    @apply text-xs text-center;
  }
  footer.socials a span {
    @apply text-gray-600 mt-2 block;
  }
  footer.socials a:hover span {
    @apply text-gray-900;
  }
</style>

<Tailwindcss />
<main class="sm:max-w-lg">
  {#if setup}
    {#if qPage < questions.length}
      <header><img src="/img/music.svg" alt="logo" /></header>
      <Question
        page={[qPage, q]}
        Hz={questions[qPage]}
        on:saveAnswer={updateAnswers} />
    {:else}
      <QuizResults {answers} />
      <footer class="grid col-gap-1 justify-center">
        <button class="btn red" on:click={resetQuiz}>Reset Quiz</button>
      </footer>
    {/if}
    <footer class="socials flex justify-items-around">
      <a
        href="https://github.com/ianpatrickbuss/pitchingfork"
        title="The code for this Quiz is open source.  View it on Github!"
        target="_bank">
        <svg
          role="img"
          viewBox="0 0 24 24"
          xmlns="http://www.w3.org/2000/svg"><title>GitHub icon</title>
          <path
            d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12" /></svg>
        <span>Check out the Code</span>
      </a>
      <a
        href="https://svelte.dev/"
        title="This site was written in Svelte so that it could be cybernetically enhanced with reactivity.  Learn more by clicking here!"
        target="_bank">
        <svg
          width="256px"
          height="308px"
          viewBox="0 0 256 308"
          version="1.1"
          xmlns="http://www.w3.org/2000/svg"
          xmlns:xlink="http://www.w3.org/1999/xlink"
          preserveAspectRatio="xMidYMid">
          <g>
            <path
              d="M239.681566,40.706757 C211.113272,-0.181889366 154.69089,-12.301439 113.894816,13.6910393 L42.2469062,59.3555354 C22.6760042,71.6680028 9.1958152,91.6538543 5.11196889,114.412133 C1.69420521,133.371174 4.6982178,152.928576 13.6483951,169.987905 C7.51549676,179.291145 3.33259428,189.7413 1.3524912,200.706787 C-2.77083771,223.902098 2.62286977,247.780539 16.3159596,266.951444 C44.8902975,307.843936 101.312954,319.958266 142.10271,293.967161 L213.75062,248.302665 C233.322905,235.991626 246.803553,216.005094 250.885557,193.246067 C254.302867,174.287249 251.30121,154.730228 242.355449,137.668922 C248.486748,128.365895 252.667894,117.916162 254.646134,106.951413 C258.772188,83.7560394 253.378243,59.8765465 239.682665,40.706757"
              fill="#FF3E00" />
            <path
              d="M106.888658,270.841265 C83.7871855,276.848065 59.3915045,267.805346 45.7864111,248.192566 C37.5477583,236.66102 34.3023491,222.296573 36.7830958,208.343155 C37.1989333,206.075414 37.7711933,203.839165 38.4957755,201.650433 L39.845476,197.534835 L43.5173097,200.231763 C51.9971301,206.462491 61.4784803,211.199728 71.5527203,214.239302 L74.2164003,215.047419 L73.9710252,217.705878 C73.6455499,221.487851 74.6696022,225.262925 76.8616703,228.361972 C80.9560313,234.269749 88.3011363,236.995968 95.2584831,235.190159 C96.8160691,234.773852 98.3006859,234.121384 99.6606718,233.25546 L171.331634,187.582718 C174.877468,185.349963 177.321139,181.729229 178.065299,177.605596 C178.808171,173.400048 177.830501,169.072361 175.351884,165.594581 C171.255076,159.685578 163.908134,156.9582 156.947927,158.762547 C155.392392,159.178888 153.90975,159.83088 152.551509,160.695872 L125.202489,178.130144 C120.705281,180.989558 115.797437,183.144784 110.64897,184.521162 C87.547692,190.527609 63.1523949,181.484801 49.5475471,161.872188 C41.3085624,150.340895 38.0631179,135.976391 40.5442317,122.023052 C43.0002744,108.333716 51.1099574,96.3125326 62.8835328,88.9089537 L134.548175,43.2323647 C139.047294,40.3682559 143.958644,38.21032 149.111311,36.8336525 C172.21244,30.8273594 196.607527,39.8700206 210.212459,59.4823515 C218.451112,71.013898 221.696522,85.3783452 219.215775,99.3317627 C218.798144,101.59911 218.225915,103.835236 217.503095,106.024485 L216.153395,110.140083 L212.483484,107.447276 C204.004261,101.212984 194.522,96.4735732 184.44615,93.4336926 L181.78247,92.6253012 L182.027845,89.9668419 C182.350522,86.1852063 181.326723,82.4111645 179.1372,79.3110228 C175.042839,73.4032457 167.697734,70.677026 160.740387,72.4828355 C159.182801,72.8991426 157.698185,73.5516104 156.338199,74.4175344 L84.6672364,120.0922 C81.1218886,122.323199 78.6795938,125.943704 77.9387928,130.066574 C77.1913232,134.271925 78.1673502,138.601163 80.6469865,142.078963 C84.7438467,147.987899 92.0907405,150.71526 99.0509435,148.910997 C100.608143,148.493836 102.092543,147.841423 103.452857,146.976298 L130.798305,129.548621 C135.293566,126.685437 140.201191,124.528302 145.350175,123.152382 C168.451453,117.145935 192.846751,126.188743 206.451598,145.801356 C214.690583,157.332649 217.936027,171.697153 215.454914,185.650492 C212.997261,199.340539 204.888162,211.362752 193.115613,218.769811 L121.450695,264.442553 C116.951576,267.306662 112.040226,269.464598 106.887559,270.841265"
              fill="#FFFFFF" />
          </g>
        </svg>
        <span>Made with Svelte</span>
      </a>
      <a
        href="https://tailwindcss.com"
        title="This site was styled using the utility-first css framework Tailwind!  Learn more by clicking here!"
        target="_bank">
        <svg role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
          <g color="#38B2AC">
            <path
              fill="currentcolor"
              d="M12.001,4.8c-3.2,0-5.2,1.6-6,4.8c1.2-1.6,2.6-2.2,4.2-1.8c0.913,0.228,1.565,0.89,2.288,1.624 C13.666,10.618,15.027,12,18.001,12c3.2,0,5.2-1.6,6-4.8c-1.2,1.6-2.6,2.2-4.2,1.8c-0.913-0.228-1.565-0.89-2.288-1.624 C16.337,6.182,14.976,4.8,12.001,4.8z M6.001,12c-3.2,0-5.2,1.6-6,4.8c1.2-1.6,2.6-2.2,4.2-1.8c0.913,0.228,1.565,0.89,2.288,1.624 c1.177,1.194,2.538,2.576,5.512,2.576c3.2,0,5.2-1.6,6-4.8c-1.2,1.6-2.6,2.2-4.2,1.8c-0.913-0.228-1.565-0.89-2.288-1.624 C10.337,13.382,8.976,12,6.001,12z" />
          </g>
        </svg>
        <span>Styled with Tailwindcss</span>
      </a>
    </footer>
  {/if}
</main>
{#if !setup}
  <div>
    <Landing on:showtime={() => (setup = true)} />
  </div>
{/if}
